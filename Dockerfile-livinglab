# Dockerfile-livinglab

# Basis-Image
FROM node:18-alpine

# Installiere PM2
RUN npm install -g pm2

# Setze das Arbeitsverzeichnis
WORKDIR /app

# Kopiere package.json und package-lock.json für Frontend
COPY frontend/package*.json ./frontend/

# Setze NPM-Registry auf das Standard-Registry
RUN npm config set registry https://registry.npmjs.org

# Installiere Abhängigkeiten für Frontend
RUN cd frontend && npm install --registry=https://registry.npmjs.org

# Kopiere den gesamten Frontend-Code
COPY frontend/ ./frontend/

# Kopiere die PM2-Konfigurationsdatei
COPY ecosystem.config.js ./ecosystem.config.js

# Exponiere die benötigten Ports
EXPOSE 3001

# Starte PM2, um sowohl Frontend als auch Backend zu starten
CMD ["pm2-runtime", "ecosystem.config.js"]
